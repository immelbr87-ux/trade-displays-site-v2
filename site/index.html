<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Trade Displays by Bargain Bond</title>
  <meta name="description" content="Verified pickup-only marketplace for showroom floor models. Transparent pricing. Escrow held until acceptance at pickup." />
  <link rel="stylesheet" href="app.css" />
</head>
<body>

  <div id="bb-header"></div>

  <div class="container section">
    <div class="hero">
      <div class="hero-inner">
        <div class="hero-copy" style="max-width:760px;">
          <div class="kicker">VERIFIED PICKUP • READY FOR TRANSIT</div>
          <h1 class="h1">The marketplace for verified showroom floor models.</h1>
          <p class="lead">
            A pickup-only exchange designed for logistics, inspection, and clean releases.
            Funds stay in escrow until the buyer accepts at pickup.
          </p>
          <div class="actions">
            <a class="btn btn-pill" href="/market">Browse floor models</a>
            <a class="btn btn-primary btn-pill" href="/pilot">Start a 30-Day Pilot</a>
          </div>
          <div class="small muted" style="margin-top:10px;">
            Safety Green is reserved for <strong>Verified</strong> and <strong>In Stock</strong> signals.
          </div>
        </div>
      </div>
    </div>

    <div class="feature-section" style="margin-top:18px;">
      <div class="feature-grid">
        <div class="feature">
          <div class="ficon"><svg viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><circle cx='12' cy='12' r='10'/><path d='M8 12l2.5 2.5L16 9'/></svg></div>
          <h3>Shop With Confidence</h3>
          <p>Every listing is structured for condition clarity and pickup inspection — built to reduce surprises.</p>
        </div>
        <div class="feature">
          <div class="ficon"><svg viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M3 3v18h18'/><path d='M7 14l3-3 3 2 5-6'/></svg></div>
          <h3>Transparent Pricing</h3>
          <p>Clear, fixed pricing for floor models — with market guidance and simple comps where available.</p>
        </div>
        <div class="feature">
          <div class="ficon"><svg viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><circle cx='12' cy='12' r='10'/><path d='M2 12h20'/><path d='M12 2a15 15 0 0 1 0 20'/><path d='M12 2a15 15 0 0 0 0 20'/></svg></div>
          <h3>Global Access</h3>
          <p>Trade buyers can secure hard-to-find models while sellers move inventory without the usual headache.</p>
        </div>
        <div class="feature">
          <div class="ficon"><svg viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M12 3l9 4.5v9L12 21 3 16.5v-9L12 3z'/><path d='M9 12l2 2 4-4'/></svg></div>
          <h3>No BS</h3>
          <p>Pickup-only. No freight claims. No post-pickup disputes. Acceptance happens on-site.</p>
        </div>
        <div class="feature">
          <div class="ficon"><svg viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><rect x='4' y='11' width='16' height='10' rx='2'/><path d='M8 11V7a4 4 0 0 1 8 0v4'/></svg></div>
          <h3>Secure</h3>
          <p>Escrow holds payment until acceptance. Identity confirmation and clear mismatch rules.</p>
        </div>
        <div class="feature">
          <div class="ficon"><svg viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M4 13v-2a8 8 0 0 1 16 0v2'/><path d='M18 13a2 2 0 0 1 2 2v1a2 2 0 0 1-2 2h-1'/><path d='M6 13a2 2 0 0 0-2 2v1a2 2 0 0 0 2 2h1'/><path d='M12 19a2 2 0 0 0 2-2v-1'/></svg></div>
          <h3>Here For You</h3>
          <p>Support and issue resolution designed around real-world pickup workflows and showroom constraints.</p>
        </div>
      </div>
    </div>

    <div style="height:18px;"></div>

    <div class="section-title">
      <h2>Featured floor models</h2>
      <p class="muted">Curated examples — browse the live market for current availability.</p>
    </div>

    <!-- Featured listings: use the same grid system as /market to avoid nested grids (which can collapse width). -->
    <div class="listings featured-grid" id="featuredListings"><div class="muted">Loading featured listings…</div></div>

    <div style="height:12px;"></div>
    <a class="btn btn-ghost btn-pill" href="/market">View the market</a>
  </div>

  <div id="bb-footer"></div>
  <script src="shared/include.js"></script>

<script>
(async function(){
  const root = document.getElementById("featuredListings");
  if(!root) return;
  try{
    const r = await fetch("/.netlify/functions/listDisplays?pageSize=8", { cache: "no-store" });
    const data = await r.json();
    if(!r.ok) throw new Error(data?.error || "Failed to load featured listings.");
    const listings = Array.isArray(data.listings) ? data.listings : (Array.isArray(data.items) ? data.items : []);
    if(!listings.length){
      root.innerHTML = '<div class="muted">No featured listings yet.</div>';
      return;
    }
    root.innerHTML = listings.slice(0,8).map(renderCard).join("");
  }catch(e){
    root.innerHTML = '<div class="muted">Unable to load featured listings.</div>';
  }

  function safeText(v){
    return String(v ?? "").replace(/[&<>"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));
  }
  function money(v){
    const n = Number(String(v||"").replace(/[^0-9.]/g,""));
    if(!isFinite(n)) return safeText(v||"");
    return "$" + n.toLocaleString(undefined,{maximumFractionDigits:0});
  }
  function pickupWindow(start,end){
    if(!start && !end) return "Pickup window disclosed";
    const s = start ? new Date(start) : null;
    const e = end ? new Date(end) : null;
    const fmt = d => d.toLocaleDateString(undefined,{month:'short', day:'numeric'});
    if(s && e) return `Pickup ${fmt(s)}–${fmt(e)}`;
    return `Pickup ${fmt(s||e)}`;
  }
  function renderCard(x){
    const id = x.id || x.recordId || x.airtableId || "";
    const title = safeText(x.title || x.name || x.product || "Showroom floor model");
    const price = money(x.price || x.list_price || x.ask || "");
    const grade = safeText((x.grade || x.condition_grade || "").toUpperCase() || "—");
    const verified = !!(x.verified || x.is_verified || x.verification === "Verified");
    const status = safeText(x.status || "In Stock");
    const ready = !!(x.ready_for_transit || x.readyForTransit);
    const img = x.thumbnail_url || x.image_url || x.image || (Array.isArray(x.images) ? x.images[0] : "");
    const thumbStyle = img ? `background-image:url('${String(img).replace(/'/g,"%27")}')` : "";
    return `
      <div class="listing">
        <div class="thumb" style="${thumbStyle}">
          <div class="thumb-badges">
            ${verified ? `<span class="pilltag verified">Verified</span>` : ``}
            <span class="pilltag instock">${status || "In Stock"}</span>
            <span class="pilltag">Pickup only</span>
            ${ready ? `<span class="pilltag ready">Ready for transit</span>` : ``}
          </div>
        </div>
        <div class="listing-body">
          <div class="title">
            <h3>${title}</h3>
            <div class="price">${price}</div>
          </div>
          <div class="meta">
            <div>Grade ${grade}</div>
            <div>${safeText(pickupWindow(x.pickup_window_start, x.pickup_window_end))}</div>
          </div>
          <div class="actions">
            <a class="btn btn-primary btn-pill" href="/reserve-confirmation.html?id=${encodeURIComponent(id)}">Reserve</a>
            <a class="btn btn-pill" href="/listing-details.html?id=${encodeURIComponent(id)}">View details</a>
          </div>
        </div>
      </div>`;
  }
})();
</script>

</body>
</html>
