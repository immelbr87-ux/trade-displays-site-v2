<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Trade Displays</title>
  <link rel="stylesheet" href="/app.css" />
</head>
<body>
  <div class="container">
    <h1>Trade Displays</h1>
    <p class="sub">Admin tools for creating and viewing display inventory.</p>

    <div class="nav">
      <a href="/market.html">Create Display</a>
      <a href="/trade-displays.html">Display Inventory</a>
      <a href="/.netlify/functions/ping" target="_blank" rel="noreferrer">Ping API</a>
    </div>

    <div class="card">
      <div class="row" style="justify-content: space-between;">
        <div>
          <div style="font-weight:700;">API status</div>
          <div class="small">Checks whether Netlify Functions are responding.</div>
        </div>
        <button class="primary" id="btnPing">Run Ping</button>
      </div>
      <div id="pingMsg"></div>
      <pre id="pingOut" style="display:none;"></pre>
    </div>

    <div class="card">
      <div style="font-weight:700; margin-bottom:6px;">Quick start</div>
      <div class="small">
        1) Go to <span class="kbd">Create Display</span> and submit a record.<br/>
        2) Go to <span class="kbd">Display Inventory</span> and load the table.
      </div>
    </div>
  </div>

<script>
  const $ = (id) => document.getElementById(id);

  function showMsg(type, text) {
    const el = $("pingMsg");
    el.innerHTML = `<div class="alert ${type}">${text}</div>`;
  }

  $("btnPing").addEventListener("click", async () => {
    $("pingOut").style.display = "none";
    $("pingOut").textContent = "";
    showMsg("ok", "Checking API...");

    try {
      const res = await fetch("/.netlify/functions/ping", { cache: "no-store" });
      const data = await res.json();
      showMsg("ok", `API OK @ ${new Date().toLocaleTimeString()}`);
      $("pingOut").style.display = "block";
      $("pingOut").textContent = JSON.stringify(data, null, 2);
    } catch (e) {
      showMsg("err", "Ping failed. Check Netlify deploy logs + Functions.");
      $("pingOut").style.display = "block";
      $("pingOut").textContent = String(e);
    }
  });
</script>
</body>
</html>
